:root {
  /* 뷰포트 기준 반응형 크기 - 텍스트 크기를 더 키움 */
  --text-size: clamp(10px, 3vmin, 32px);
  --line-gap: clamp(4px, 0.8vmin, 10px);
  --padding: clamp(20px, 4vmin, 50px);
  --border-width: clamp(1px, 0.2vmin, 3px);
  --button-padding: clamp(6px, 1vmin, 12px) clamp(12px, 2vmin, 24px);
  --button-font: clamp(10px, 1.5vmin, 18px);
  --title-font: clamp(16px, 3vmin, 36px);
  --popup-font: clamp(12px, 1.8vmin, 22px);
}

* { 
  box-sizing: border-box; 
  image-rendering: pixelated;
  image-rendering: -moz-crisp-edges;
  image-rendering: crisp-edges;
}

body {
  margin: 0;
  padding: 0;
  background: black;
  font-family: 'Share Tech Mono', 'Courier New', monospace;
  color: white;
  overflow: hidden;
  
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  width: 100vw;
  
  letter-spacing: 0.5px;
}

/* 게임 컨테이너 - 4:3 비율 유지 */
.game-container {
  width: 100vw;
  height: 100vh;
  background: black;
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
}

.game-container::before {
  content: "";
  display: block;
  width: min(100vw, calc(100vh * 4 / 3));
  height: min(100vh, calc(100vw * 3 / 4));
  border: var(--border-width) solid #333;
  border-radius: clamp(2px, 0.3vmin, 6px);
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: -1;
}

.game-content {
  width: min(100vw, calc(100vh * 4 / 3));
  height: min(100vh, calc(100vw * 3 / 4));
  position: relative;
  background: black;
  border-radius: clamp(2px, 0.3vmin, 6px);
  overflow: hidden;
}

/* 숨김 */
.hidden { 
  display: none !important; 
}

/* 메인 메뉴 */
.menu {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: clamp(12px, 2vmin, 24px);
  padding: var(--padding);
}

.menu h1 {
  font-size: var(--title-font);
  margin: 0;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
  text-align: center;
}

/* 버튼 스타일 */
button {
  padding: var(--button-padding);
  font-size: var(--button-font);
  border-radius: clamp(2px, 0.4vmin, 6px);
  border: none;
  cursor: pointer;
  background: #444;
  color: white;
  min-width: clamp(100px, 15vmin, 200px);
  font-family: inherit;
  transition: background-color 0.2s;
}

button:hover { background: #555; }
button:active { background: #666; }

/* 게임 화면 */
#game-screen {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}

/* 배경 */
#background {
  position: absolute;
  inset: 0;
  background: #111 center/cover no-repeat;
  z-index: 0;
  image-rendering: pixelated;
}

/* 캐릭터 */
#character {
  position: absolute;
  bottom: 0;
  z-index: 1;
  width: 100%;
  text-align: center;
  height: 75%;
  max-height: 75%;
  left: 50%;
  transform: translateX(-50%);
  transition: left 0.5s ease, transform 0.5s ease;

  /* 캐릭터 영역 클릭/드래그 차단 */
  pointer-events: none;
}

#character.pos-left { left: 20%; transform: translateX(-50%); }
#character.pos-right { left: 80%; transform: translateX(-50%); }
#character.pos-center { left: 50%; transform: translateX(-50%); }

#character img {
  max-height: 100%;
  max-width: 85%;
  height: auto;
  width: auto;
  display: block;
  image-rendering: pixelated;
  margin: 0 auto;
  object-fit: contain;

  /* 이미지도 선택/클릭 차단 */
  user-select: none;
  pointer-events: none;
}

/* 페이드 레이어 */
#fadeLayer {
  position: absolute;
  inset: 0;
  background: black;
  opacity: 0;
  transition: opacity 1s ease;
  z-index: 2;
  pointer-events: none;
}

/* 텍스트 영역 */
#text-area {
  position: absolute;
  top: var(--padding);
  left: calc(var(--padding) * 2);
  right: calc(var(--padding) * 2);
  z-index: 3;
  font-size: var(--text-size);
  line-height: 1.6;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.9);

  /* 텍스트 선택/드래그 차단 */
  user-select: none;

  height: calc(22% - var(--padding));
  min-height: calc(22% - var(--padding));
  max-height: calc(22% - var(--padding));
  overflow: visible;
  padding-left: 2vw;
  padding-right: 2vw;
}

/* 개별 줄 */
.line {
  opacity: 1;
  transform: none;
  margin: 0 0 var(--line-gap) 0;
  white-space: pre-wrap;
  word-break: keep-all;
  font-size: var(--text-size);
  font-family: 'Share Tech Mono', 'Courier New', monospace;
  letter-spacing: 0.5px;
}

/* 팝업 */
.popup {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0, 0, 0, 0.95);
  border: var(--border-width) solid rgba(255, 255, 255, 0.2);
  padding: clamp(16px, 3vmin, 32px);
  z-index: 10;
  min-width: clamp(200px, 30vmin, 400px);
  text-align: center;
  border-radius: clamp(4px, 0.5vmin, 8px);
  backdrop-filter: blur(5px);
}

.popup h2 {
  margin: 0 0 clamp(12px, 2vmin, 20px) 0;
  font-size: var(--popup-font);
}

.popup button { margin: clamp(4px, 0.5vmin, 8px); }

/* 스크롤바 */
#text-area::-webkit-scrollbar { width: clamp(4px, 0.5vmin, 8px); }
#text-area::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.1);
  border-radius: clamp(2px, 0.3vmin, 4px);
}
#text-area::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.3);
  border-radius: clamp(2px, 0.3vmin, 4px);
}
#text-area::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.5); }

/* 작은 화면 대응 */
@media (max-height: 400px) {
  #text-area {
    height: calc(30% - var(--padding));
    min-height: calc(30% - var(--padding));
    max-height: calc(30% - var(--padding));
    font-size: clamp(12px, 2.2vmin, 24px);
  }
  #character { height: 70%; max-height: 70%; }
  #character img { max-width: 80%; }
}

/* 세로 긴 화면 */
@media (max-aspect-ratio: 4/3) {
  #text-area {
    height: calc(28% - var(--padding));
    min-height: calc(28% - var(--padding));
    max-height: calc(28% - var(--padding));
  }
  #character { height: 72%; max-height: 72%; }
  #character img { max-width: 80%; }
}

/* 가로 긴 화면 */
@media (min-aspect-ratio: 16/9) {
  #text-area {
    height: calc(22% - var(--padding));
    min-height: calc(22% - var(--padding));
    max-height: calc(22% - var(--padding));
  }
  #character { height: 78%; max-height: 78%; }
  #character img { max-width: 90%; }
}

/* 매우 작은 화면 */
@media (max-width: 360px), (max-height: 300px) {
  .menu { gap: clamp(8px, 1.5vmin, 16px); }
  #text-area {
    height: calc(35% - var(--padding));
    min-height: calc(35% - var(--padding));
    max-height: calc(35% - var(--padding));
    font-size: clamp(10px, 2vw, 14px);
    line-height: 1.4;
  }
  #character { height: 65%; max-height: 65%; }
  #character img { max-width: 75%; }
}

/* 모바일 환경에서 텍스트 더 작게 */
@media (max-width: 480px) {
  :root {
    --text-size: clamp(8px, 2vw, 14px);
  }
}

/* 화면 흔들림 애니메이션 - 충격 효과 */
@keyframes impact-light {
  0% { transform: translate(0, 0); }
  2% { transform: translate(-1px, 0); }
  4% { transform: translate(2px, -1px); }
  6% { transform: translate(-2px, 1px); }
  8% { transform: translate(1px, -1px); }
  10% { transform: translate(-1px, 0); }
  12% { transform: translate(1px, 1px); }
  14% { transform: translate(0, -1px); }
  16% { transform: translate(-1px, 0); }
  100% { transform: translate(0, 0); }
}

@keyframes impact-medium {
  0% { transform: translate(0, 0); }
  2% { transform: translate(-3px, 0); }
  4% { transform: translate(4px, -2px); }
  6% { transform: translate(-4px, 2px); }
  8% { transform: translate(3px, -3px); }
  10% { transform: translate(-2px, 1px); }
  12% { transform: translate(2px, 2px); }
  14% { transform: translate(-1px, -2px); }
  16% { transform: translate(1px, 1px); }
  18% { transform: translate(-1px, 0); }
  100% { transform: translate(0, 0); }
}

@keyframes impact-strong {
  0% { transform: translate(0, 0); }
  1% { transform: translate(-6px, 0); }
  3% { transform: translate(8px, -4px); }
  5% { transform: translate(-8px, 4px); }
  7% { transform: translate(6px, -6px); }
  9% { transform: translate(-4px, 3px); }
  11% { transform: translate(4px, 4px); }
  13% { transform: translate(-3px, -4px); }
  15% { transform: translate(2px, 2px); }
  17% { transform: translate(-2px, -1px); }
  19% { transform: translate(1px, 1px); }
  100% { transform: translate(0, 0); }
}

@keyframes impact-extreme {
  0% { transform: translate(0, 0); }
  1% { transform: translate(-12px, 0); }
  2% { transform: translate(15px, -8px); }
  3% { transform: translate(-15px, 8px); }
  4% { transform: translate(12px, -10px); }
  5% { transform: translate(-10px, 6px); }
  6% { transform: translate(8px, 8px); }
  7% { transform: translate(-6px, -8px); }
  8% { transform: translate(6px, 4px); }
  9% { transform: translate(-4px, -3px); }
  10% { transform: translate(3px, 3px); }
  11% { transform: translate(-2px, -2px); }
  12% { transform: translate(2px, 1px); }
  13% { transform: translate(-1px, 1px); }
  100% { transform: translate(0, 0); }
}

/* 흔들림 클래스들 - 충격 효과 */
.shake-1-25 {
  animation: impact-light 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.shake-26-50 {
  animation: impact-medium 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.shake-51-75 {
  animation: impact-strong 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.shake-76-100 {
  animation: impact-extreme 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}